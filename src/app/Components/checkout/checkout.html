<div class="checkout-container">
  <!-- Header -->
  <div class="checkout-header">
    <h1>âœ… Checkout</h1>
    <div class="checkout-steps">
      <span class="step active">ğŸ›’ Cart</span>
      <span class="step active">ğŸ“ Checkout</span>
      <span class="step">âœ… Confirmation</span>
    </div>
  </div>

  <!-- Login Required -->
  <div *ngIf="!isLoggedIn()" class="login-required">
    <h2>Please login to proceed with checkout</h2>
    <p>You need to be logged in to place an order.</p>
    <a routerLink="/login" class="btn-login">Login Now</a>
  </div>

  <!-- Main Content (Only for logged-in users) -->
  <div *ngIf="isLoggedIn()">
    <!-- Loading State -->
    <div *ngIf="isLoading" class="loading-state">
      <div class="loading-spinner"></div>
      <p>Loading your cart...</p>
    </div>

    <!-- Empty Cart -->
    <div *ngIf="!isLoading && cartItems.length === 0" class="empty-cart">
      <div class="empty-icon">ğŸ›’</div>
      <h2>Your cart is empty</h2>
      <p>Add some items to your cart before checkout.</p>
      <a routerLink="/home" class="btn-shop">Continue Shopping</a>
    </div>

    <!-- Checkout Form -->
    <div *ngIf="!isLoading && cartItems.length > 0" class="checkout-content">
      <div class="checkout-form-section">
        <h2>ğŸ“‹ Shipping Information</h2>
        
        <form (ngSubmit)="placeOrder()" #checkoutForm="ngForm">
          <!-- Shipping Address -->
          <div class="form-group">
            <label for="shippingAddress">ğŸ“« Shipping Address *</label>
            <textarea 
              id="shippingAddress" 
              name="shippingAddress"
              [(ngModel)]="orderData.shippingAddress"
              rows="3"
              placeholder="Enter your complete address"
              required
            ></textarea>
          </div>

          <!-- City, State, Zip -->
          <div class="form-row">
            <div class="form-group">
              <label for="city">ğŸ™ï¸ City *</label>
              <input 
                type="text" 
                id="city" 
                name="city"
                [(ngModel)]="orderData.city"
                placeholder="Enter your city"
                required
              >
            </div>
            
            <div class="form-group">
              <label for="state">ğŸ—ºï¸ State *</label>
              <input 
                type="text" 
                id="state" 
                name="state"
                [(ngModel)]="orderData.state"
                placeholder="Enter your state"
                required
              >
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="zipCode">ğŸ“® Zip Code *</label>
              <input 
                type="text" 
                id="zipCode" 
                name="zipCode"
                [(ngModel)]="orderData.zipCode"
                placeholder="Enter zip code"
                required
                pattern="[0-9]{6}"
              >
            </div>
            
            <div class="form-group">
              <label for="phoneNumber">ğŸ“± Phone Number *</label>
              <input 
                type="tel" 
                id="phoneNumber" 
                name="phoneNumber"
                [(ngModel)]="orderData.phoneNumber"
                placeholder="Enter your phone number"
                required
                pattern="[0-9]{10}"
              >
            </div>
          </div>

          <!-- Payment Method -->
          <div class="form-group">
            <h3>ğŸ’³ Payment Method</h3>
            <div class="payment-options">
              <label *ngFor="let method of paymentMethods" class="payment-option">
                <input 
                  type="radio" 
                  name="paymentMethod"
                  [(ngModel)]="orderData.paymentMethod"
                  [value]="method.name"
                  [checked]="method.id === 'cod'"
                >
                <span class="radio-label">{{ method.name }}</span>
              </label>
            </div>
          </div>

          <!-- Order Items Preview -->
          <div class="order-items-preview">
            <h3>ğŸ“¦ Order Items ({{ totalItems }})</h3>
            <div class="preview-items">
              <div *ngFor="let item of cartItems" class="preview-item">
                <img [src]="getImageUrl(item.imagePath)" [alt]="item.productName">
                <div class="preview-details">
                  <h4>{{ item.productName }}</h4>
                  <p>{{ item.quantity }} Ã— {{ formatPrice(item.productPrice) }}</p>
                </div>
                <div class="preview-total">
                  {{ formatPrice(item.totalPrice) }}
                </div>
              </div>
            </div>
          </div>

          <!-- Submit Button -->
          <div class="form-actions">
            <button 
              type="button" 
              class="btn-back"
              (click)="router.navigate(['/cart'])"
            >
              â† Back to Cart
            </button>
            
            <button 
              type="submit" 
              class="btn-place-order"
              [disabled]="isSubmitting || checkoutForm.invalid"
            >
              {{ isSubmitting ? 'Placing Order...' : 'Place Order' }}
            </button>
          </div>
        </form>
      </div>

      <!-- Order Summary -->
      <div class="order-summary-section">
        <div class="order-summary">
          <h2>ğŸ’° Order Summary</h2>
          
          <div class="summary-details">
            <div class="summary-row">
              <span>Subtotal ({{ totalItems }} items)</span>
              <span>{{ formatPrice(totalAmount) }}</span>
            </div>
            
            <div class="summary-row">
              <span>Shipping</span>
              <span class="free">FREE</span>
            </div>
            
            <div class="summary-row">
              <span>Tax</span>
              <span>{{ formatPrice(totalAmount * 0.18) }}</span>
            </div>
            
            <div class="summary-row total">
              <span>Total Amount</span>
              <span class="total-amount">{{ formatPrice(totalAmount + (totalAmount * 0.18)) }}</span>
            </div>
          </div>

          <!-- Order Benefits -->
          <div class="order-benefits">
            <h3>âœ… Benefits</h3>
            <ul>
              <li>ğŸšš Free delivery on all orders</li>
              <li>ğŸ”’ Secure payment</li>
              <li>ğŸ”„ 7-day return policy</li>
              <li>ğŸ“ 24/7 customer support</li>
            </ul>
          </div>

          <!-- Contact Info -->
          <div class="contact-info">
            <h3>ğŸ“ Need Help?</h3>
            <p>Call us: +92 3116432102</p>
            <p>Email: kashif@dryfruitstore.com</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>